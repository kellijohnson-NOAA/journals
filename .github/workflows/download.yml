# Workflow derived from https://github.com/r-lib/actions/tree/master/examples

name: sync math.utah.edu fishery-journals
on: [push]
  # workflow_dispatch:
  # schedule:
  #   - cron: "0 13 * * 1"

jobs:
  mirror-website:
    name: mirrors the website
    runs-on: ubuntu-latest
    steps:
    # - name: Checkout Code
    #   uses: actions/checkout@v2
      - name: wget
      # uses: wei/wget@v1
      # with:
        # args: -O fishery-journals.txt -P ./inst/math.utah.edu/ http://www.math.edu/~beebe/.fishery-journals/fishery-journals.txt
        run: wget -d -O fishery-journals.txt -P /inst/math.utah.edu/ http://www.math.utah.edu/~beebe/.fishery-journals/fishery-journals.txt
      # - name: get last commit msg
      #   id: commit-msg
      #   run: |
      #     git tag
      #     last_commit_msg=$(git log -1 --pretty=%B)
      #     echo "::set-output name=msg::${last_commit_msg}"
      # -name: Move list of journals to inst/math.utah.edu
      #   run: mv fishery-journal.txt inst/math.utah.edu/fishery-journals.txt
      # - name: Fetch files
      #   run: for f in ` cat inst/math.utah.edu/fish*txt `; do rsync -av rsync://ftp.math.utah.edu/bib/$f ./inst/math.utah.edu/$f; done
        
      # - name: Create Pull Request
      #   if: ${{ !contains(steps.commit-msg.outputs.msg, 'run')}}
      #   uses: peter-evans/create-pull-request@v3
      #   with:
      #     commit-message: 'Updates fishery-journal files'
      #     branch: download
      #     title: 'Updates fishery-journal files'
      #     body: |
      #      Auto-generated by [download.yml][1]
      #        [1]: https://github.com/kellijohnson-NOAA/journals/tree/main/.github/workflows/download.yml

# List of exit codes for wget:
# 0       No problems occurred
# 1       Generic error code
# 2       Parse error — for instance, when parsing command-line options, the .wgetrc or .netrc…
# 3       File I/O error
# 4       Network failure
# 5       SSL verification failure
# 6       Username/password authentication failure
# 7       Protocol errors
# 8       Server issued an error response
